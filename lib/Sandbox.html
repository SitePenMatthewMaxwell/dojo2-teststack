<!DOCTYPE html>
<html>
	<body>
		<script src="../dojo/dojo.js" data-dojo-config="async: true"></script>
		<script>
		var basePath = location.pathname.replace(/[^\/]+$/, '') + '../';
		require({
			baseUrl: basePath,
			packages: [
				{ name: 'dojo-ts', location: basePath + 'dojo' },
				{ name: 'teststack', location: basePath },
				{ name: 'chai', location: basePath + 'chai', main: 'chai' },
				{ name: 'dojo2-teststack', location: basePath }
			]
		}, ['dojo-ts/on', 'require', 'lib/reporters/iframe'], function (on, require, iframe) {
			on(window, 'load', function () {
				iframe.post('Sandbox initialized');
			});

			on(window, 'message', function (event) {
				var data = JSON.parse(event.data);

				if (data.type === 'loadTest') {
					require(['teststack/client'], function () {
						iframe.post('Client loaded');
					});
				} else {
					iframe.post('Unknown type')
				}
			});
		});
		</script>
	</body>
</html>